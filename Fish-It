-- üé£ Fish It! Webhook Notifier (Client-Side)
-- Pastikan nama RemoteEvent sesuai dengan yang ada di ReplicatedStorage

local Players = game:GetService("Players")
local player = Players.LocalPlayer
local ReplicatedStorage = game:GetService("ReplicatedStorage")

-- üîó Ganti dengan URL Webhook Discord kamu
local WEBHOOK_URL = "https://discord.com/api/webhooks/1421461949522251838/Izr6hElwGceXBgCOPiJ8TjqNQCTBceKv-B46eVt_CCCjtgcMGrBM0ZDGWIedg16H54UF" -- ‚Üê GANTI DENGAN WEBHOOK KAMU

-- üéØ RemoteEvent dari server (pastikan namanya benar)
local fishEvent = ReplicatedStorage:WaitForChild("FishCaught")

-- üì§ Fungsi kirim webhook dengan embed keren
local function sendWebhook(fishName, fishRarity, fishValue)
    -- üé® Tentukan warna embed berdasarkan rarity
    local rarityColors = {
        Common = 0xAAAAAA,      -- Abu-abu
        Uncommon = 0x55FF55,    -- Hijau
        Rare = 0x5555FF,        -- Biru
        Epic = 0xAA55FF,        -- Ungu
        Legendary = 0xFFAA00,   -- Emas
        Mythic = 0xFF5555       -- Merah
    }
    local color = rarityColors[fishRarity] or 0x000000

    -- üì¶ Payload Discord Webhook (dengan embed)
    local data = {
        username = "üé£ Fish It! Notifier",
        avatar_url = "https://i.imgur.com/6hXbF0A.png", -- Opsional: ganti dengan avatar kamu
        embeds = {
            {
                title = "üéâ Ikan Baru Ditangkap!",
                description = "Pemain **" .. player.Name .. "** berhasil menangkap ikan langka!",
                color = color,
                fields = {
                    {
                        name = "üêü Nama Ikan",
                        value = "**" .. fishName .. "**",
                        inline = true
                    },
                    {
                        name = "‚ú® Rarity",
                        value = "**" .. fishRarity .. "**",
                        inline = true
                    },
                    {
                        name = "üí∞ Nilai",
                        value = "**" .. tostring(fishValue) .. "** koin",
                        inline = true
                    }
                },
                footer = {
                    text = "Fish It! ‚Ä¢ Notifikasi Otomatis",
                    icon_url = "https://i.imgur.com/fish-icon.png" -- Opsional
                },
                timestamp = os.date("!%Y-%m-%dT%H:%M:%SZ")
            }
        }
    }

    -- üîÅ Kirim ke Discord via HTTP POST
    spawn(function()
        local success, response = pcall(function()
            return game:HttpGetAsync({
                Url = WEBHOOK_URL,
                Method = "POST",
                Headers = { ["Content-Type"] = "application/json" },
                Body = game:GetService("HttpService"):JSONEncode(data)
            })
        end)

        if not success then
            warn("‚ùå Gagal mengirim webhook:", response)
        else
            print("‚úÖ Webhook terkirim untuk ikan:", fishName)
        end
    end)
end

-- üé£ Dengarkan event saat ikan ditangkap
fishEvent.OnClientEvent:Connect(function(fishName, fishRarity, fishValue)
    sendWebhook(fishName, fishRarity, fishValue)
end)